This is essentially a piece of https://github.com/NixOS/nixpkgs/blob/2f4ba842f9419509d2ce7ff1765023f83e1007c6/pkgs/build-support/agda/default.nix, but with ability to typecheck all files in certain directory.

Planning to upstream sometime.
